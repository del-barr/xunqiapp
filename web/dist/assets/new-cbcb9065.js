import{b as E,i as M}from"./api-5c6fbd67.js";import{d as C,u as T,r as v,W as O,o as _,c as g,b as m,a as e,l as o,F as U,h as k,j as R,i as w,M as r,X as $,Y as L,E as j,Z as D,_ as G,B as H,$ as J,S as K,a0 as P,p as W,g as X}from"./index-d6e7f6d7.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";const Z=f=>(W("data-v-3d0aeea1"),f=f(),X(),f),q={class:"boxw"},Q={class:"box-n"},ee=Z(()=>m("p",{class:"title"},"新增应用",-1)),ae={style:{width:"100%",display:"flex"}},le={style:{width:"100%",display:"flex"}},te={style:{width:"100%",display:"flex"}},oe={style:{width:"100%",display:"flex"}},se={class:"imnagebox",style:{position:"relative","margin-right":"20px"}},ne=["src"],de={style:{width:"100%",display:"flex"}},ue=C({__name:"new",setup(f){const V=T(),S=v(null),d=v({ap_icon:[],ap_topimg:[],ap_image:[]}),l=O({}),x=v([]);(async()=>{let n=await E({});n.status==200?x.value=n.data:r.error({content:n.message})})();const I=async()=>{l.ap_icon=d.value.ap_icon[0].url,l.ap_topimg=d.value.ap_topimg[0].url,l.ap_imagelist=JSON.stringify(d.value.ap_image);let n=await M(l);n.status==200?(r.success("新增成功"),V.push("/Admin/applist")):n.status==204?(r.warning("登录失效 请重新登录"),localStorage.removeItem("SEM07_MANAGE_TOKEN"),V.push("/Admin/login")):n.status==299?V.push("/Admin/299"):r.warning(n.message)},y=n=>{r.error(`文件 ${n.name} 上传失败`)},h=n=>(console.log(n),{url:n.data.url}),F=n=>(d.value.ap_image.push({url:n.data.url}),{url:""});return(n,t)=>{const c=$,s=L,u=j,i=D,p=G,b=H,B=J,N=K,z=P;return _(),g("div",q,[m("div",Q,[ee,e(z,{ref_key:"form",ref:S,data:l,"scroll-to-first-error":"smooth",onSubmit:I},{default:o(()=>[m("div",ae,[e(s,{label:"应用图标",name:""},{default:o(()=>[e(c,{modelValue:d.value.ap_icon,"onUpdate:modelValue":t[0]||(t[0]=a=>d.value.ap_icon=a),action:"/upload",theme:"image",accept:"image/*","format-response":h,onFail:y},null,8,["modelValue"])]),_:1}),e(s,{label:"顶部图片",help:"",name:"specifications"},{default:o(()=>[e(c,{modelValue:d.value.ap_topimg,"onUpdate:modelValue":t[1]||(t[1]=a=>d.value.ap_topimg=a),action:"/upload",theme:"image",accept:"image/*","format-response":h,onFail:y},null,8,["modelValue"])]),_:1})]),m("div",le,[e(s,{label:"应用名称",name:"or_merchandiser"},{default:o(()=>[e(u,{modelValue:l.ap_name,"onUpdate:modelValue":t[2]||(t[2]=a=>l.ap_name=a)},null,8,["modelValue"])]),_:1}),e(s,{label:"应用大小",name:"se_signatory"},{default:o(()=>[e(u,{modelValue:l.ap_size,"onUpdate:modelValue":t[3]||(t[3]=a=>l.ap_size=a)},null,8,["modelValue"])]),_:1}),e(s,{label:"下载次数",name:"se_signatory"},{default:o(()=>[e(u,{modelValue:l.ap_downnum,"onUpdate:modelValue":t[4]||(t[4]=a=>l.ap_downnum=a)},null,8,["modelValue"])]),_:1}),e(s,{label:"应用版本",name:"se_signatory"},{default:o(()=>[e(u,{modelValue:l.ap_version,"onUpdate:modelValue":t[5]||(t[5]=a=>l.ap_version=a)},null,8,["modelValue"])]),_:1})]),m("div",te,[e(s,{label:"应用标签",name:"or_merchandiser"},{default:o(()=>[e(u,{modelValue:l.ap_label,"onUpdate:modelValue":t[6]||(t[6]=a=>l.ap_label=a)},null,8,["modelValue"])]),_:1}),e(s,{label:"应用评分",name:"se_signatory"},{default:o(()=>[e(u,{modelValue:l.ap_score,"onUpdate:modelValue":t[7]||(t[7]=a=>l.ap_score=a)},null,8,["modelValue"])]),_:1}),e(s,{label:"所属分类",name:"se_signatory"},{default:o(()=>[e(p,{style:{width:"180px"},modelValue:l.ap_classid,"onUpdate:modelValue":t[8]||(t[8]=a=>l.ap_classid=a)},{default:o(()=>[(_(!0),g(U,null,k(x.value,a=>(_(),R(i,{key:"1",label:a.cl_name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"应用简介",name:"se_signatory"},{default:o(()=>[e(u,{modelValue:l.ap_brief,"onUpdate:modelValue":t[9]||(t[9]=a=>l.ap_brief=a)},null,8,["modelValue"])]),_:1})]),e(s,{label:"下载链接",name:"se_signatory"},{default:o(()=>[e(u,{modelValue:l.ap_downurl,"onUpdate:modelValue":t[10]||(t[10]=a=>l.ap_downurl=a)},null,8,["modelValue"])]),_:1}),m("div",oe,[e(s,{label:"应用截图",name:"or_merchandiser"},{default:o(()=>[(_(!0),g(U,null,k(d.value.ap_image,(a,A)=>(_(),g("div",se,[m("img",{src:a.url,style:{width:"80px",height:"130px","border-radius":"10px"},alt:""},null,8,ne),e(b,{size:"small",theme:"danger",style:{position:"absolute","z-index":"110",top:"0",right:"0"},onClick:me=>d.value.ap_image.splice(A,1)},{default:o(()=>[w("删除")]),_:2},1032,["onClick"])]))),256)),e(c,{action:"/upload",theme:"image",accept:"image/*",multiple:"",max:8,"abridge-name":[6,6],"format-response":F,onFail:y})]),_:1})]),e(s,{style:{"margin-top":"20px"},label:"应用介绍",name:"se_signatory"},{default:o(()=>[e(B,{modelValue:l.ap_introduce,"onUpdate:modelValue":t[11]||(t[11]=a=>l.ap_introduce=a),placeholder:"请输入内容(支持HTML代码)"},null,8,["modelValue"])]),_:1}),m("div",de,[e(s,{label:"是否热门",name:"or_merchandiser"},{default:o(()=>[e(p,{style:{width:"100px"},modelValue:l.ap_hotshow,"onUpdate:modelValue":t[12]||(t[12]=a=>l.ap_hotshow=a)},{default:o(()=>[e(i,{key:"1",label:"是",value:"1"}),e(i,{key:"2",label:"否",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"是否必备",name:"se_signatory"},{default:o(()=>[e(p,{style:{width:"100px"},modelValue:l.ap_necshow,"onUpdate:modelValue":t[13]||(t[13]=a=>l.ap_necshow=a)},{default:o(()=>[e(i,{key:"1",label:"是",value:"1"}),e(i,{key:"2",label:"否",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"是否置顶",name:"se_signatory"},{default:o(()=>[e(p,{style:{width:"100px"},modelValue:l.ap_navshow,"onUpdate:modelValue":t[14]||(t[14]=a=>l.ap_navshow=a)},{default:o(()=>[e(i,{key:"1",label:"是",value:"1"}),e(i,{key:"2",label:"否",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"置顶权重",name:"se_signatory"},{default:o(()=>[e(u,{style:{width:"100px"},modelValue:l.ap_top_index,"onUpdate:modelValue":t[15]||(t[15]=a=>l.ap_top_index=a)},null,8,["modelValue"])]),_:1}),e(s,{label:"应用状态",name:"se_signatory"},{default:o(()=>[e(p,{style:{width:"100px"},modelValue:l.ap_type,"onUpdate:modelValue":t[16]||(t[16]=a=>l.ap_type=a)},{default:o(()=>[e(i,{key:"1",label:"显示",value:"1"}),e(i,{key:"2",label:"隐藏",value:"2"})]),_:1},8,["modelValue"])]),_:1})]),e(s,{style:{"margin-top":"20px"}},{default:o(()=>[e(N,{size:"small"},{default:o(()=>[e(b,{theme:"primary",type:"submit"},{default:o(()=>[w(" 下一步 ")]),_:1}),e(b,{theme:"default",variant:"base",type:"reset"},{default:o(()=>[w(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["data"])])])}}});const fe=Y(ue,[["__scopeId","data-v-3d0aeea1"]]);export{fe as default};
