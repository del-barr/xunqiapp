import{b as M,c as C,d as T,e as O,u as R}from"./api-5c6fbd67.js";import{d as $,u as L,r as g,o as v,c as f,b as m,a as e,l as s,F as k,h as S,j,i as x,M as i,X as D,Y as G,E as H,Z as J,_ as K,B as P,$ as X,S as Y,a0 as Z,p as q,g as Q}from"./index-d6e7f6d7.js";import{_ as W}from"./_plugin-vue_export-helper-c27b6911.js";const ee=_=>(q("data-v-661f9f6b"),_=_(),Q(),_),ae={class:"boxw"},le={class:"box-n"},te=ee(()=>m("p",{class:"title"},"新增应用",-1)),oe={style:{width:"100%",display:"flex"}},se={style:{width:"100%",display:"flex"}},ne={style:{width:"100%",display:"flex"}},ue={style:{width:"100%",display:"flex"}},de={class:"imnagebox",style:{position:"relative","margin-right":"20px"}},pe=["src"],ie={style:{width:"100%",display:"flex"}},me=$({__name:"post",props:["id"],setup(_){const c=_,y=L(),I=g(null),u=g({ap_icon:[],ap_topimg:[],ap_image:[]}),l=g({}),h=g([]);(async()=>{let o=await M({});o.status==200?h.value=o.data:i.error({content:o.message})})(),(async()=>{let o=await C({id:c.id});o.status==200?(l.value=o.data,u.value.ap_icon[0]={url:o.data.ap_icon},u.value.ap_topimg[0]={url:o.data.ap_topimg}):i.error({content:o.message})})(),(async()=>{let o=await T({id:c.id});o.status==200?u.value.ap_image=o.data:i.error({content:o.message})})(),(async()=>{let o=await O({id:c.id,type:1});o.status==200?l.value.ap_downurl=o.data[0].url:i.error({content:o.message})})();const F=async()=>{l.value.ap_icon=u.value.ap_icon[0].url,l.value.ap_topimg=u.value.ap_topimg[0].url,l.value.ap_imagelist=JSON.stringify(u.value.ap_image);let o=await R(l.value);o.status==200?(i.success("新增成功"),y.push("/Admin/applist")):o.status==204?(i.warning("登录失效 请重新登录"),localStorage.removeItem("SEM07_MANAGE_TOKEN"),y.push("/Admin/login")):o.status==299?y.push("/Admin/299"):i.warning(o.message)},V=o=>{i.error(`文件 ${o.name} 上传失败`)},U=o=>(console.log(o),{url:o.data.url}),B=o=>(u.value.ap_image.push({url:o.data.url}),{url:""});return(o,t)=>{const b=D,n=G,d=H,p=J,r=K,w=P,N=X,z=Y,A=Z;return v(),f("div",ae,[m("div",le,[te,e(A,{ref_key:"form",ref:I,data:l.value,"scroll-to-first-error":"smooth",onSubmit:F},{default:s(()=>[m("div",oe,[e(n,{label:"应用图标",name:""},{default:s(()=>[e(b,{modelValue:u.value.ap_icon,"onUpdate:modelValue":t[0]||(t[0]=a=>u.value.ap_icon=a),action:"/upload",theme:"image",accept:"image/*","format-response":U,onFail:V},null,8,["modelValue"])]),_:1}),e(n,{label:"顶部图片",help:"",name:"specifications"},{default:s(()=>[e(b,{modelValue:u.value.ap_topimg,"onUpdate:modelValue":t[1]||(t[1]=a=>u.value.ap_topimg=a),action:"/upload",theme:"image",accept:"image/*","format-response":U,onFail:V},null,8,["modelValue"])]),_:1})]),m("div",se,[e(n,{label:"应用名称",name:"or_merchandiser"},{default:s(()=>[e(d,{modelValue:l.value.ap_name,"onUpdate:modelValue":t[2]||(t[2]=a=>l.value.ap_name=a)},null,8,["modelValue"])]),_:1}),e(n,{label:"应用大小",name:"se_signatory"},{default:s(()=>[e(d,{modelValue:l.value.ap_size,"onUpdate:modelValue":t[3]||(t[3]=a=>l.value.ap_size=a)},null,8,["modelValue"])]),_:1}),e(n,{label:"下载次数",name:"se_signatory"},{default:s(()=>[e(d,{modelValue:l.value.ap_downnum,"onUpdate:modelValue":t[4]||(t[4]=a=>l.value.ap_downnum=a)},null,8,["modelValue"])]),_:1}),e(n,{label:"应用版本",name:"se_signatory"},{default:s(()=>[e(d,{modelValue:l.value.ap_version,"onUpdate:modelValue":t[5]||(t[5]=a=>l.value.ap_version=a)},null,8,["modelValue"])]),_:1})]),m("div",ne,[e(n,{label:"应用标签",name:"or_merchandiser"},{default:s(()=>[e(d,{modelValue:l.value.ap_label,"onUpdate:modelValue":t[6]||(t[6]=a=>l.value.ap_label=a)},null,8,["modelValue"])]),_:1}),e(n,{label:"应用评分",name:"se_signatory"},{default:s(()=>[e(d,{modelValue:l.value.ap_score,"onUpdate:modelValue":t[7]||(t[7]=a=>l.value.ap_score=a)},null,8,["modelValue"])]),_:1}),e(n,{label:"所属分类",name:"se_signatory"},{default:s(()=>[e(r,{style:{width:"180px"},modelValue:l.value.ap_classid,"onUpdate:modelValue":t[8]||(t[8]=a=>l.value.ap_classid=a)},{default:s(()=>[(v(!0),f(k,null,S(h.value,a=>(v(),j(p,{key:"1",label:a.cl_name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(n,{label:"应用简介",name:"se_signatory"},{default:s(()=>[e(d,{modelValue:l.value.ap_brief,"onUpdate:modelValue":t[9]||(t[9]=a=>l.value.ap_brief=a)},null,8,["modelValue"])]),_:1})]),e(n,{label:"下载链接",name:"se_signatory"},{default:s(()=>[e(d,{modelValue:l.value.ap_downurl,"onUpdate:modelValue":t[10]||(t[10]=a=>l.value.ap_downurl=a),style:{width:"200px"}},null,8,["modelValue"])]),_:1}),m("div",ue,[e(n,{label:"应用截图",name:"or_merchandiser"},{default:s(()=>[(v(!0),f(k,null,S(u.value.ap_image,(a,E)=>(v(),f("div",de,[m("img",{src:a.url,style:{width:"80px",height:"130px","border-radius":"10px"},alt:""},null,8,pe),e(w,{size:"small",theme:"danger",style:{position:"absolute","z-index":"110",top:"0",right:"0"},onClick:fe=>u.value.ap_image.splice(E,1)},{default:s(()=>[x("删除")]),_:2},1032,["onClick"])]))),256)),e(b,{action:"/upload",theme:"image",accept:"image/*",multiple:"",max:8,"abridge-name":[6,6],"format-response":B,onFail:V})]),_:1})]),e(n,{style:{"margin-top":"20px"},label:"应用介绍",name:"se_signatory"},{default:s(()=>[e(N,{modelValue:l.value.ap_introduce,"onUpdate:modelValue":t[11]||(t[11]=a=>l.value.ap_introduce=a),placeholder:"请输入内容(支持HTML代码)"},null,8,["modelValue"])]),_:1}),m("div",ie,[e(n,{label:"是否热门",name:"or_merchandiser"},{default:s(()=>[e(r,{style:{width:"100px"},modelValue:l.value.ap_hotshow,"onUpdate:modelValue":t[12]||(t[12]=a=>l.value.ap_hotshow=a)},{default:s(()=>[e(p,{key:"1",label:"是",value:"1"}),e(p,{key:"2",label:"否",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(n,{label:"是否必备",name:"se_signatory"},{default:s(()=>[e(r,{style:{width:"100px"},modelValue:l.value.ap_necshow,"onUpdate:modelValue":t[13]||(t[13]=a=>l.value.ap_necshow=a)},{default:s(()=>[e(p,{key:"1",label:"是",value:"1"}),e(p,{key:"2",label:"否",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(n,{label:"是否置顶",name:"se_signatory"},{default:s(()=>[e(r,{style:{width:"100px"},modelValue:l.value.ap_navshow,"onUpdate:modelValue":t[14]||(t[14]=a=>l.value.ap_navshow=a)},{default:s(()=>[e(p,{key:"1",label:"是",value:"1"}),e(p,{key:"2",label:"否",value:"2"})]),_:1},8,["modelValue"])]),_:1}),e(n,{label:"置顶权重",name:"se_signatory"},{default:s(()=>[e(d,{style:{width:"100px"},modelValue:l.value.ap_top_index,"onUpdate:modelValue":t[15]||(t[15]=a=>l.value.ap_top_index=a)},null,8,["modelValue"])]),_:1}),e(n,{label:"应用状态",name:"se_signatory"},{default:s(()=>[e(r,{style:{width:"100px"},modelValue:l.value.ap_type,"onUpdate:modelValue":t[16]||(t[16]=a=>l.value.ap_type=a)},{default:s(()=>[e(p,{key:"1",label:"显示",value:"1"}),e(p,{key:"2",label:"隐藏",value:"2"})]),_:1},8,["modelValue"])]),_:1})]),e(n,{style:{"margin-top":"20px"}},{default:s(()=>[e(z,{size:"small"},{default:s(()=>[e(w,{theme:"primary",type:"submit"},{default:s(()=>[x(" 下一步 ")]),_:1}),e(w,{theme:"default",variant:"base",type:"reset"},{default:s(()=>[x(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1},8,["data"])])])}}});const be=W(me,[["__scopeId","data-v-661f9f6b"]]);export{be as default};
